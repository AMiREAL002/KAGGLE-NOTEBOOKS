{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/subhammudi/13-04-2022-ml-lab-5?scriptVersionId=93363009\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"code","execution_count":1,"id":"7f3d27dd","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2022-04-18T16:11:04.59944Z","iopub.status.busy":"2022-04-18T16:11:04.598294Z","iopub.status.idle":"2022-04-18T16:11:04.608792Z","shell.execute_reply":"2022-04-18T16:11:04.609386Z","shell.execute_reply.started":"2022-04-18T16:09:55.349139Z"},"papermill":{"duration":0.02301,"end_time":"2022-04-18T16:11:04.60974","exception":false,"start_time":"2022-04-18T16:11:04.58673","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)"]},{"cell_type":"code","execution_count":2,"id":"68c47ca2","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:04.62803Z","iopub.status.busy":"2022-04-18T16:11:04.627129Z","iopub.status.idle":"2022-04-18T16:11:04.664316Z","shell.execute_reply":"2022-04-18T16:11:04.663716Z","shell.execute_reply.started":"2022-04-18T16:09:55.359941Z"},"papermill":{"duration":0.047362,"end_time":"2022-04-18T16:11:04.664502","exception":false,"start_time":"2022-04-18T16:11:04.61714","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cgpa</th>\n","      <th>communication</th>\n","      <th>aptitude</th>\n","      <th>progskill</th>\n","      <th>class</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>139</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>140</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>141</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>142</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>143</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>144 rows Ã— 5 columns</p>\n","</div>"],"text/plain":["     cgpa  communication  aptitude  progskill  class\n","0       2              1         1          1      1\n","1       1              1         1          1      1\n","2       0              0         0          1      0\n","3       0              1         0          0      0\n","4       2              1         1          0      1\n","..    ...            ...       ...        ...    ...\n","139     0              1         0          1      0\n","140     2              0         0          0      0\n","141     1              0         1          1      0\n","142     2              0         0          0      0\n","143     1              1         1          0      1\n","\n","[144 rows x 5 columns]"]},"execution_count":2,"metadata":{},"output_type":"execute_result"}],"source":["df = pd.read_csv(\"../input/stud-employ/Stud_Employ (2).csv\")\n","df"]},{"cell_type":"code","execution_count":3,"id":"8cf8f155","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:04.68339Z","iopub.status.busy":"2022-04-18T16:11:04.682455Z","iopub.status.idle":"2022-04-18T16:11:05.943581Z","shell.execute_reply":"2022-04-18T16:11:05.942877Z","shell.execute_reply.started":"2022-04-18T16:09:55.382926Z"},"papermill":{"duration":1.271442,"end_time":"2022-04-18T16:11:05.943738","exception":false,"start_time":"2022-04-18T16:11:04.672296","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.metrics import accuracy_score\n","from sklearn.neighbors import KNeighborsClassifier\n","from sklearn.metrics import confusion_matrix\n","from sklearn.model_selection import train_test_split"]},{"cell_type":"code","execution_count":4,"id":"8e215f4c","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:05.965896Z","iopub.status.busy":"2022-04-18T16:11:05.965194Z","iopub.status.idle":"2022-04-18T16:11:05.971985Z","shell.execute_reply":"2022-04-18T16:11:05.971413Z","shell.execute_reply.started":"2022-04-18T16:09:55.390831Z"},"papermill":{"duration":0.020953,"end_time":"2022-04-18T16:11:05.972157","exception":false,"start_time":"2022-04-18T16:11:05.951204","status":"completed"},"tags":[]},"outputs":[],"source":["predictors = df.iloc[:, 0:4]\n","target = df.iloc[:,4]\n","predictors_train, predictors_test,target_train, target_test=train_test_split(predictors, target, test_size=0.3, random_state = 123)"]},{"cell_type":"code","execution_count":5,"id":"45334300","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:05.996199Z","iopub.status.busy":"2022-04-18T16:11:05.995545Z","iopub.status.idle":"2022-04-18T16:11:05.997959Z","shell.execute_reply":"2022-04-18T16:11:05.998388Z","shell.execute_reply.started":"2022-04-18T16:09:55.411819Z"},"papermill":{"duration":0.018962,"end_time":"2022-04-18T16:11:05.998573","exception":false,"start_time":"2022-04-18T16:11:05.979611","status":"completed"},"tags":[]},"outputs":[],"source":["nn = KNeighborsClassifier(n_neighbors = 3)\n","model = nn.fit(predictors_train, target_train)"]},{"cell_type":"code","execution_count":6,"id":"b1aea735","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:06.016696Z","iopub.status.busy":"2022-04-18T16:11:06.016002Z","iopub.status.idle":"2022-04-18T16:11:06.027672Z","shell.execute_reply":"2022-04-18T16:11:06.027183Z","shell.execute_reply.started":"2022-04-18T16:09:55.427152Z"},"papermill":{"duration":0.022093,"end_time":"2022-04-18T16:11:06.027824","exception":false,"start_time":"2022-04-18T16:11:06.005731","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["1.0"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["nn.score(predictors_test, target_test)"]},{"cell_type":"code","execution_count":7,"id":"880bb1c1","metadata":{"execution":{"iopub.execute_input":"2022-04-18T16:11:06.054119Z","iopub.status.busy":"2022-04-18T16:11:06.052845Z","iopub.status.idle":"2022-04-18T16:11:06.064332Z","shell.execute_reply":"2022-04-18T16:11:06.064973Z","shell.execute_reply.started":"2022-04-18T16:09:55.447371Z"},"papermill":{"duration":0.029956,"end_time":"2022-04-18T16:11:06.065249","exception":false,"start_time":"2022-04-18T16:11:06.035293","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([[23,  0],\n","       [ 0, 21]])"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["predictions =nn.predict (predictors_test)\n","confusion_matrix(target_test,predictions)"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.12"},"papermill":{"default_parameters":{},"duration":11.241911,"end_time":"2022-04-18T16:11:06.791187","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-04-18T16:10:55.549276","version":"2.3.3"}},"nbformat":4,"nbformat_minor":5}